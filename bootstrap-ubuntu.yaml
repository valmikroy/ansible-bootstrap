---
- name: Ubuntu bootstrap playbook
  become: true
  hosts: localhost
  connection: local

  tasks:
    - name: install necessary packages
      apt:
        name: "{{ item }}"
      loop:
        - nvim
        - jq
        - curl
        - ansible
        - ansible-lint
        - sshpass
        - git
        - yamllint
        - tmux
        - samba
        - cups
        - printer-driver-brlaser  
        - avahi-daemon  
        - brother-cups-wrapper-laser
        - brother-cups-wrapper-laser1
        - cups-ipp-utils  
    - name: Adding existing user {{ user }} to group sudo
      user:
        name: "{{ user }}"
        groups: 
          - sudo
          - sys  
          - lpadmin
        append: yes
    - name: sudo access by group
      copy:
        content: | 
          %sudo ALL=(ALL:ALL) ALL
          {{ user }} ALL=(ALL) NOPASSWD: ALL
        dest: /etc/sudoers.d/sudo_with_passwd
        mode: 0440
